package com.farhannz.kaitou.data.models

import androidx.compose.runtime.LaunchedEffect
import kotlinx.coroutines.delay
import kotlinx.serialization.SerialName
import kotlinx.serialization.Serializable
import kotlinx.serialization.json.Json
import org.opencv.core.Point


data class BoundingBox (
    val x1: Float,
    val y1: Float,
    val x2: Float,
    val y2: Float
)

data class OCRResult(
    val word: String,
    val bbox : BoundingBox
)


@Serializable
data class PpOcrResponse(
    @SerialName("rec_texts") val texts: List<String>,
    @SerialName("rec_polys") val boxes: List<List<List<Float>>>
    // You can add other fields like rec_scores if needed
)
data class TokenInfo(
    val surface: String,   // raw form, for bbox
    val baseForm: String?,  // dictionary form, for lookup
    val partOfSpeech: String
)
sealed class OCRUIState {
    object ProcessingOCR : OCRUIState()

    object Failed : OCRUIState()
    object Done : OCRUIState()
}


//Detection Result = [
//  [Point(x,y), Point(x,y), Point(x,y), Point(x,y)],
//  [Point(x,y), Point(x,y), Point(x,y), Point(x,y)],
//  [Point(x,y), Point(x,y), Point(x,y), Point(x,y)],
//  [Point(x,y), Point(x,y), Point(x,y), Point(x,y)]
// ]

data class GroupedResult(val detections : DetectionResult, val grouped: List<List<Point>>)
data class DetectionResult(val boxes: List<List<Point>>, val scores: List<Double>)


class MockResult {

    fun result() : String {
        return """
            {
              "model_settings": {
                "use_doc_preprocessor": false,
                "use_textline_orientation": false
              },
              "dt_polys": [
                [
                  [
                    40,
                    18
                  ],
                  [
                    112,
                    18
                  ],
                  [
                    112,
                    50
                  ],
                  [
                    40,
                    50
                  ]
                ],
                [
                  [
                    184,
                    25
                  ],
                  [
                    209,
                    25
                  ],
                  [
                    209,
                    47
                  ],
                  [
                    184,
                    47
                  ]
                ],
                [
                  [
                    31,
                    97
                  ],
                  [
                    48,
                    97
                  ],
                  [
                    48,
                    110
                  ],
                  [
                    31,
                    110
                  ]
                ],
                [
                  [
                    76,
                    97
                  ],
                  [
                    438,
                    93
                  ],
                  [
                    438,
                    128
                  ],
                  [
                    76,
                    132
                  ]
                ],
                [
                  [
                    555,
                    97
                  ],
                  [
                    595,
                    97
                  ],
                  [
                    595,
                    128
                  ],
                  [
                    555,
                    128
                  ]
                ],
                [
                  [
                    49,
                    112
                  ],
                  [
                    64,
                    112
                  ],
                  [
                    64,
                    127
                  ],
                  [
                    49,
                    127
                  ]
                ],
                [
                  [
                    96,
                    165
                  ],
                  [
                    181,
                    165
                  ],
                  [
                    181,
                    208
                  ],
                  [
                    96,
                    208
                  ]
                ],
                [
                  [
                    110,
                    293
                  ],
                  [
                    689,
                    293
                  ],
                  [
                    689,
                    332
                  ],
                  [
                    110,
                    332
                  ]
                ],
                [
                  [
                    611,
                    455
                  ],
                  [
                    633,
                    455
                  ],
                  [
                    633,
                    478
                  ],
                  [
                    611,
                    478
                  ]
                ],
                [
                  [
                    602,
                    501
                  ],
                  [
                    643,
                    504
                  ],
                  [
                    637,
                    593
                  ],
                  [
                    595,
                    589
                  ]
                ],
                [
                  [
                    364,
                    566
                  ],
                  [
                    401,
                    568
                  ],
                  [
                    397,
                    685
                  ],
                  [
                    360,
                    684
                  ]
                ],
                [
                  [
                    390,
                    568
                  ],
                  [
                    425,
                    568
                  ],
                  [
                    425,
                    682
                  ],
                  [
                    390,
                    682
                  ]
                ],
                [
                  [
                    301,
                    600
                  ],
                  [
                    318,
                    600
                  ],
                  [
                    318,
                    617
                  ],
                  [
                    301,
                    617
                  ]
                ],
                [
                  [
                    565,
                    595
                  ],
                  [
                    588,
                    595
                  ],
                  [
                    588,
                    615
                  ],
                  [
                    565,
                    615
                  ]
                ],
                [
                  [
                    315,
                    769
                  ],
                  [
                    354,
                    780
                  ],
                  [
                    334,
                    856
                  ],
                  [
                    295,
                    846
                  ]
                ],
                [
                  [
                    300,
                    930
                  ],
                  [
                    329,
                    930
                  ],
                  [
                    329,
                    1022
                  ],
                  [
                    300,
                    1022
                  ]
                ],
                [
                  [
                    323,
                    928
                  ],
                  [
                    357,
                    928
                  ],
                  [
                    357,
                    1082
                  ],
                  [
                    323,
                    1082
                  ]
                ],
                [
                  [
                    431,
                    1263
                  ],
                  [
                    638,
                    1269
                  ],
                  [
                    636,
                    1341
                  ],
                  [
                    429,
                    1334
                  ]
                ],
                [
                  [
                    464,
                    1321
                  ],
                  [
                    728,
                    1327
                  ],
                  [
                    727,
                    1387
                  ],
                  [
                    463,
                    1381
                  ]
                ],
                [
                  [
                    461,
                    1372
                  ],
                  [
                    611,
                    1372
                  ],
                  [
                    611,
                    1418
                  ],
                  [
                    461,
                    1418
                  ]
                ],
                [
                  [
                    440,
                    1428
                  ],
                  [
                    535,
                    1428
                  ],
                  [
                    535,
                    1465
                  ],
                  [
                    440,
                    1465
                  ]
                ],
                [
                  [
                    539,
                    1423
                  ],
                  [
                    661,
                    1423
                  ],
                  [
                    661,
                    1452
                  ],
                  [
                    539,
                    1452
                  ]
                ],
                [
                  [
                    2,
                    1452
                  ],
                  [
                    183,
                    1452
                  ],
                  [
                    183,
                    1475
                  ],
                  [
                    2,
                    1475
                  ]
                ],
                [
                  [
                    539,
                    1450
                  ],
                  [
                    680,
                    1450
                  ],
                  [
                    680,
                    1478
                  ],
                  [
                    539,
                    1478
                  ]
                ]
              ],
              "text_det_params": {
                "limit_side_len": 960,
                "limit_type": "max",
                "thresh": 0.3,
                "max_side_limit": 4000,
                "box_thresh": 0.6,
                "unclip_ratio": 1.5
              },
              "text_type": "general",
              "textline_orientation_angles": [
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1,
                -1
              ],
              "text_rec_score_thresh": 0,
              "rec_texts": [
                "11:22",
                "C",
                "O",
                "mangaraw.moe/read/bu",
                "35",
                "O",
                "第8話",
                "画面をタップしてステイッキーを無効にする",
                "O",
                "千ラ",
                "冬が訪れた",
                "深淵の森",
                "0",
                "O",
                "千ラ",
                "雪景色だ",
                "屋敷もすっかり",
                "不死王",
                "スローライフを",
                "希望します",
                "第8話",
                "原作小狐丸",
                "mangaraw.co",
                "漫画小滝力"
              ],
              "rec_scores": [
                0.9729430079460144,
                0.7365719676017761,
                0.49551254510879517,
                0.9993067979812622,
                0.9986041784286499,
                0.6245291829109192,
                0.9996379017829895,
                0.9985594749450684,
                0.6209395527839661,
                0.7565000653266907,
                0.9080461263656616,
                0.7884386777877808,
                0.477240651845932,
                0.49362459778785706,
                0.6070523262023926,
                0.9280092716217041,
                0.8992851376533508,
                0.9745108485221863,
                0.8593264818191528,
                0.932916522026062,
                0.8770859837532043,
                0.9993435144424438,
                0.9498647451400757,
                0.9621631503105164
              ],
              "rec_polys": [
                [
                  [
                    40,
                    18
                  ],
                  [
                    112,
                    18
                  ],
                  [
                    112,
                    50
                  ],
                  [
                    40,
                    50
                  ]
                ],
                [
                  [
                    184,
                    25
                  ],
                  [
                    209,
                    25
                  ],
                  [
                    209,
                    47
                  ],
                  [
                    184,
                    47
                  ]
                ],
                [
                  [
                    31,
                    97
                  ],
                  [
                    48,
                    97
                  ],
                  [
                    48,
                    110
                  ],
                  [
                    31,
                    110
                  ]
                ],
                [
                  [
                    76,
                    97
                  ],
                  [
                    438,
                    93
                  ],
                  [
                    438,
                    128
                  ],
                  [
                    76,
                    132
                  ]
                ],
                [
                  [
                    555,
                    97
                  ],
                  [
                    595,
                    97
                  ],
                  [
                    595,
                    128
                  ],
                  [
                    555,
                    128
                  ]
                ],
                [
                  [
                    49,
                    112
                  ],
                  [
                    64,
                    112
                  ],
                  [
                    64,
                    127
                  ],
                  [
                    49,
                    127
                  ]
                ],
                [
                  [
                    96,
                    165
                  ],
                  [
                    181,
                    165
                  ],
                  [
                    181,
                    208
                  ],
                  [
                    96,
                    208
                  ]
                ],
                [
                  [
                    110,
                    293
                  ],
                  [
                    689,
                    293
                  ],
                  [
                    689,
                    332
                  ],
                  [
                    110,
                    332
                  ]
                ],
                [
                  [
                    611,
                    455
                  ],
                  [
                    633,
                    455
                  ],
                  [
                    633,
                    478
                  ],
                  [
                    611,
                    478
                  ]
                ],
                [
                  [
                    602,
                    501
                  ],
                  [
                    643,
                    504
                  ],
                  [
                    637,
                    593
                  ],
                  [
                    595,
                    589
                  ]
                ],
                [
                  [
                    364,
                    566
                  ],
                  [
                    401,
                    568
                  ],
                  [
                    397,
                    685
                  ],
                  [
                    360,
                    684
                  ]
                ],
                [
                  [
                    390,
                    568
                  ],
                  [
                    425,
                    568
                  ],
                  [
                    425,
                    682
                  ],
                  [
                    390,
                    682
                  ]
                ],
                [
                  [
                    301,
                    600
                  ],
                  [
                    318,
                    600
                  ],
                  [
                    318,
                    617
                  ],
                  [
                    301,
                    617
                  ]
                ],
                [
                  [
                    565,
                    595
                  ],
                  [
                    588,
                    595
                  ],
                  [
                    588,
                    615
                  ],
                  [
                    565,
                    615
                  ]
                ],
                [
                  [
                    315,
                    769
                  ],
                  [
                    354,
                    780
                  ],
                  [
                    334,
                    856
                  ],
                  [
                    295,
                    846
                  ]
                ],
                [
                  [
                    300,
                    930
                  ],
                  [
                    329,
                    930
                  ],
                  [
                    329,
                    1022
                  ],
                  [
                    300,
                    1022
                  ]
                ],
                [
                  [
                    323,
                    928
                  ],
                  [
                    357,
                    928
                  ],
                  [
                    357,
                    1082
                  ],
                  [
                    323,
                    1082
                  ]
                ],
                [
                  [
                    431,
                    1263
                  ],
                  [
                    638,
                    1269
                  ],
                  [
                    636,
                    1341
                  ],
                  [
                    429,
                    1334
                  ]
                ],
                [
                  [
                    464,
                    1321
                  ],
                  [
                    728,
                    1327
                  ],
                  [
                    727,
                    1387
                  ],
                  [
                    463,
                    1381
                  ]
                ],
                [
                  [
                    461,
                    1372
                  ],
                  [
                    611,
                    1372
                  ],
                  [
                    611,
                    1418
                  ],
                  [
                    461,
                    1418
                  ]
                ],
                [
                  [
                    440,
                    1428
                  ],
                  [
                    535,
                    1428
                  ],
                  [
                    535,
                    1465
                  ],
                  [
                    440,
                    1465
                  ]
                ],
                [
                  [
                    539,
                    1423
                  ],
                  [
                    661,
                    1423
                  ],
                  [
                    661,
                    1452
                  ],
                  [
                    539,
                    1452
                  ]
                ],
                [
                  [
                    2,
                    1452
                  ],
                  [
                    183,
                    1452
                  ],
                  [
                    183,
                    1475
                  ],
                  [
                    2,
                    1475
                  ]
                ],
                [
                  [
                    539,
                    1450
                  ],
                  [
                    680,
                    1450
                  ],
                  [
                    680,
                    1478
                  ],
                  [
                    539,
                    1478
                  ]
                ]
              ],
              "rec_boxes": [
                [
                  40,
                  18,
                  112,
                  50
                ],
                [
                  184,
                  25,
                  209,
                  47
                ],
                [
                  31,
                  97,
                  48,
                  110
                ],
                [
                  76,
                  93,
                  438,
                  132
                ],
                [
                  555,
                  97,
                  595,
                  128
                ],
                [
                  49,
                  112,
                  64,
                  127
                ],
                [
                  96,
                  165,
                  181,
                  208
                ],
                [
                  110,
                  293,
                  689,
                  332
                ],
                [
                  611,
                  455,
                  633,
                  478
                ],
                [
                  595,
                  501,
                  643,
                  593
                ],
                [
                  360,
                  566,
                  401,
                  685
                ],
                [
                  390,
                  568,
                  425,
                  682
                ],
                [
                  301,
                  600,
                  318,
                  617
                ],
                [
                  565,
                  595,
                  588,
                  615
                ],
                [
                  295,
                  769,
                  354,
                  856
                ],
                [
                  300,
                  930,
                  329,
                  1022
                ],
                [
                  323,
                  928,
                  357,
                  1082
                ],
                [
                  429,
                  1263,
                  638,
                  1341
                ],
                [
                  463,
                  1321,
                  728,
                  1387
                ],
                [
                  461,
                  1372,
                  611,
                  1418
                ],
                [
                  440,
                  1428,
                  535,
                  1465
                ],
                [
                  539,
                  1423,
                  661,
                  1452
                ],
                [
                  2,
                  1452,
                  183,
                  1475
                ],
                [
                  539,
                  1450,
                  680,
                  1478
                ]
              ]
            }
        """.trimIndent()
    }
}